---
layout: post
title: DEFCON 26 CTFåƒè³½è¨˜
author: MaskRay
tags: [security, defcon, ctf, contest]
---

ä»Šå¹´ä½œçˆ²Tea Deliverersä¸€å“¡åƒåŠ DEFCON 26 CTFã€‚Redbudã€Nu1Lã€ROISã€é•·äº­ç§‘æŠ€å¹¾å€‹å“¡å·¥çµ„æˆTea Deliverersï¼Œåœ¨DEFCON 26 CTF Qualsä¸­æ™‰ç´šFinalsã€‚DEFCON 21~25 CTFçš„ä¸»è¾¦æ–¹Legitimate Business Syndicateé€€ä¼‘ä¹‹å¾ŒåŸä¾†Shellphishçš„ä¸€äº›äººçµ„æˆoooverflowæ¥æ‰‹äº†ã€‚æˆ‘å€‘æ¨æ¸¬è³½åˆ¶å¯èƒ½æœƒç™¼ç”Ÿè¼ƒå¤§è®ŠåŒ–(å¾€å¹´ä½¿ç”¨ä¸€ç¨®é›¶å’Œè³½åˆ¶ï¼Œè¢«å¾ˆå¤šæ¯”è³½çš„æ±ºè³½æ²¿ç”¨)ã€‚

<!-- more -->

åƒåŠ æ±ºè³½çš„éšŠä¼å¾15æ”¯å¢åŠ åˆ°äº†24æ”¯ï¼š

<table>
<tr><td>1</td><td>0daysober</td></tr>
<tr><td>2</td><td>A&#42;0&#42;E</td></tr>
<tr><td>3</td><td>BFS</td></tr>
<tr><td>4</td><td>binja</td></tr>
<tr><td>5</td><td>C.G.K.S</td></tr>
<tr><td>6</td><td>DEFKOR00T</td></tr>
<tr><td>7</td><td>Dragon Sector</td></tr>
<tr><td>8</td><td>HITCON</td></tr>
<tr><td>9</td><td>hxp</td></tr>
<tr><td>10</td><td>KaisHack+PLUS+GoN</td></tr>
<tr><td>11</td><td>koreanbadass</td></tr>
<tr><td>12</td><td>mhackeroni</td></tr>
<tr><td>13</td><td>pasten</td></tr>
<tr><td>14</td><td>PPP</td></tr>
<tr><td>15</td><td>PwnThyBytes</td></tr>
<tr><td>16</td><td>r3kapig</td></tr>
<tr><td>17</td><td>RPISEC</td></tr>
<tr><td>18</td><td>Samurai</td></tr>
<tr><td>19</td><td>Sauercloud</td></tr>
<tr><td>20</td><td>Shellphish</td></tr>
<tr><td>21</td><td>Spaceballs</td></tr>
<tr><td>22</td><td>Tea Deliverers</td></tr>
<tr><td>23</td><td>TeamBaguette</td></tr>
<tr><td>24</td><td>TokyoWesterns</td></tr>
</table>

å…¶ä¸­ï¼ŒA\*0\*E(æµ™æ±Ÿå¤§å­¸AAA+ä¸Šæµ·äº¤å¤§0ops+é¨°è¨Šeee+å¾©æ—¦å¤§å­¸å…­æ˜Ÿ)ã€r3kapig(Eur3kA+FlappyPig)ã€Tea Deliverersæ˜¯ä¾†è‡ªä¸­åœ‹å¤§é™¸çš„éšŠä¼ã€‚BFS(äº¤é€šå¤§å­¸BambooFoxã€è‡ºç£å¤§å­¸Balsnã€ä¸­å¤®å¤§å­¸DoubleSigmaä»¥åŠä¸­ç§‘é™¢Kerkeryuan CTF)ã€HITCONæ˜¯ä¾†è‡ªè‡ºç£çš„éšŠä¼ã€‚

è³½å‰æˆ‘åˆå­¸ç¿’äº†ä¸€äº›radare2ï¼Œåœ¨ç¼ºä¹å¯¦è¸çš„æƒ…æ³ä¸‹ç™¼äº†ä¸€äº›ç°¡å–®çš„pull requestsï¼Œæ”¹é€²tabè£œå…¨ã€æé«˜switch caseçš„å¯è®€æ€§ã€ä¿®å¾©ä¸€äº›bugã€æ”¹é€²meson build systemç­‰ã€‚
![](/static/2018-08-13-defcon-26-ctf/radare2.webp)

> We will run one power cable and one ethernet cable for each team. You will access the game over the ethernet cable using ipv4. We plan to provide internet access over this same link, however, this depends somewhat on the hotel's cooperation, so please be prepared for the contingency where we don't have internet, have filtered internet, or the world suddenly switches to FreeBSD and ipv6.

è »æœŸå¾…æœ‰FreeBSDçš„ï¼Œå› çˆ²æˆ‘åœ¨llvmè£æœ‰ä¸€äº›(å¾®å°çš„)FreeBSD commitsï¼Œå¯æƒœæˆ‘å€‘éƒ½çŸ¥é“FreeBSD ASLRé“é˜»ä¸”é•·ã€‚

## 8æœˆ8æ—¥

åŒ—äº¬æ™‚é–“8æœˆ8æ—¥å¾åŒ—äº¬å‡ºç™¼çš„riatreå’Œmarche147åœ¨Pacific Daylight Timeä¸­åˆåˆ°é”ï¼Œéš¨å¾Œå¾SJCå‡ºç™¼çš„æˆ‘ä¹Ÿåˆ°é”äº†ï¼Œå› çˆ²æ‰‹æ©ŸAT&Tä¿¡è™Ÿä¸å¥½æ²’æœ‰æ³¨æ„å’Œä»–å€‘å…ˆåŒ¯åˆï¼Œç¨è‡ªæ‰“è»Šå»Caesars Palaceï¼Œé€ æˆå¤šé¤˜é–‹éŠ·ã€‚åˆ°é”å¾Œcheck in Palace Towerçš„å…©é–“æˆ¿ï¼Œåœ¨æ¨“ä¸‹å»å¹´åƒéå¹¾æ¬¡çš„åŒ—äº¬ä¹è™Ÿåƒæ¨é²çš„åˆé£¯ã€‚

Tea Delivererså¤§éƒ¨éšŠä¹˜åKorean Airèˆªç­ï¼Œåœ¨é¦–çˆ¾è½‰æ©Ÿæ™‚å‰ä¸€ç­å»¶èª¤å°è‡´è¶•ä¸ä¸Šå»Las Vegasçš„ï¼Œåœ¨é¦–çˆ¾å¤šå¾…äº†ä¸€å¤©ã€‚ä»–å€‘å¸¶ç€æ¯”è³½éœ€è¦çš„NUCå’Œè·¯ç”±å™¨ã€‚å› æ­¤æˆ‘å€‘ä¸‰å€‹äººæ²’æœ‰è¾¦æ³•æå‰åšäº›æº–å‚™(riatreç¨±ä¹‹çˆ²â€œä¿®é›»è…¦â€)ã€‚cxmå’Œckxä¹Ÿåˆ°é”äº†ï¼Œå‡ºå»æ¡è³¼ã€‚

r3kapigä¸€äº›éšŠå“¡ä¹Ÿåœ¨ä»Šå¤©åˆ°é”äº†ã€‚æ™šä¸Šriatreã€marche147å’Œæˆ‘æ‰¾ä»–å€‘å››å€‹éšŠå“¡(Atumã€å…©ä½å¤©æ´¥å¤§å­¸å­¸ç”Ÿã€ä¸€å€‹åƒåŠ éISC'16çš„USTCå­¸ç”Ÿ)åƒé£¯ï¼Œè·¯ä¸Šé‡åˆ°äº†slipperå’ŒTiffany Baoï¼ŒåŸæ¥ä»–ä»¬ä¹Ÿæ˜¯ä¸»è¾¦æ–¹oooverflowæˆå“¡ã€‚slipperå¾å°æ‰‹ã€è¯åˆæˆ°éšŠéšŠå‹ã€é¡§å•(DEFCON 25 CTF)åˆ°ä¸»è¾¦æ–¹ğŸ˜®ã€‚

## 8æœˆ9æ—¥

cxm 9:00é ˜å–çµ¦æ¯”è³½é¸æ‰‹æä¾›çš„8å€‹badges(é€²å…¥æœƒå ´çš„æ†‘è­‰)ï¼Œå› æ­¤åŒæ™‚åœ¨è³½å ´çš„é¸æ‰‹åªèƒ½æœ‰8å€‹(å…¶å¯¦å¾ˆå¤šé¸æ‰‹æ›´é¡˜æ„å¾…åœ¨é…’åº—ï¼Œå› çˆ²ç¾å ´å˜ˆé›œ)ã€‚ä»Šå¹´æ®µæµ·æ–°è€å¸«å’ŒåŠ‰ä¿å›çµ¦æˆ‘å€‘æä¾›å¾Œå‹¤æ”¯æŒ(æ¡è³¼æ°´ã€é£Ÿç‰©ã€è¨‚åˆé¤æ™šé¤)ã€‚ä¸‹åˆæ¡è³¼æ±è¥¿ã€‚

å¾åŒ—äº¬å‡ºç™¼çš„å¤§éƒ¨éšŠæ™šä¸Šåˆ°é”ï¼Œåœ¨Caesars Palaceé–‹äº†ä¸€é–“Forum Classic Suiteã€‚æœ‰ä¸€é–“Palace Toweræˆ¿é–“å› çˆ²å»¶é²ä¸€å¤©check inè¢«å–æ¶ˆäº†ï¼Œå¥½åœ¨å¾Œä¾†å‡è‰™äº†ã€‚

ä¸‹åˆcxmå’Œckxå»Blackhatæœƒå ´è²·Tæ¤è¡«ã€‚riatreå’Œæˆ‘æ‹¿ç€badgeå»æœƒå ´çœ‹çœ‹ã€‚ä½†æ ¹æ“šå¾€å¹´ç¶“é©—ï¼ŒDEFCONç¬¬ä¸€å¤©ä¸¦æ²’æœ‰å¤šå°‘æ´»å‹•ï¼Œä¸»è¦æ´»å‹•æ™‚é–“å’ŒCTFé‡ç–Šã€‚

æ™šä¸Šæ®µæµ·æ–°è€å¸«è«‹æˆ‘å€‘åœ¨Paris Las Vegasçš„Le Village Buffetåƒé£¯ã€‚ä½œçˆ²å¸¸å¹´åƒåŠ DEFCON CTF Finalsçš„é¸æ‰‹ç™¼ç¾ä»Šå¹´ç†Ÿæ‚‰çš„kelwinã€libmaruã€eadomä¸è¦‹äº†ï¼Œä¼¼ä¹éƒ½æ˜¯æ–°é®®çš„é¢å­”ï¼šcclsç”¨æˆ¶iromise(åƒåŠ éASC'16ï¼Œç¾ä»»æ¸…è¯å¤§å­¸å­¸ç”Ÿç¶²çµ¡å®‰å…¨æŠ€è¡“å”æœƒæœƒé•·)ã€å»å¹´é‚„èƒ½å›ç­”çŸ¥ä¹å•é¡Œâ€œé«˜ä¸­ç”Ÿè¿›å…¥å„å¤§CTFçš„Finalæ˜¯æ€æ ·çš„ä¸€ç§ä½“éªŒï¼Ÿâ€çš„Mistyã€æ¸…è¯å¤§å­¸åœ°çƒç³»çµ±ç§‘å­¸ç³»çš„wirefishã€ç½‘ç»œç ”ç©¶é™¢çš„ckxã€ä¸‰å€‹ç¶“å¸¸æ›´æ›idçš„webæ‰‹(chromium1337ã€kericwyã€wupco)ï¼Œå‹æƒ…æ”¯æ´æˆ‘å€‘çš„åœ¨UC Riversideäº¤æ¢çš„å´ç‚œã€‚

å›å»å¾Œå¤§å®¶åœ¨å¥—æˆ¿é›†åˆï¼ŒBrieflyXç·¨æ’äº†æ¯”è³½ç¾å ´å’Œå¥—æˆ¿æ¡ç”¨çš„ç¶²çµ¡ç’°å¢ƒï¼šç¾å ´ä½¿ç”¨NUCï¼Œå¥—æˆ¿æ”¾ç½®æ¥µè·¯ç”±(OpenWRTï¼Œæˆ‘å€‘å°e1000eé©…å‹•å‚³è¼¸å¤§æ–‡ä»¶å®¹æ˜“å‡ºå•é¡Œçš„ç‹€æ³å·²ç¶“æœ‰å¿ƒç„¡åŠ›ï¼Œä½¿ç”¨äº†ä¸€å€‹USB to Ethernet adapter)ï¼Œå…©è€…é€£æ¥ä¸€å€‹ç¾åœ‹VPSéƒ¨ç½²çš„OpenVPN serverã€‚æ¬¡æ—¥ç²å¾—æ¯”è³½ç¾å ´ä½¿ç”¨çš„å…§ç¶²åœ°å€å¾Œï¼Œéœ€è¦ä¿®æ”¹OpenVPN serverè¨­ç½®push routeå’Œirouteæ¨é€è·¯ç”±(å¾Œä¾†æ“šèªªr3kapigçš„irouteé…ç½®éŒ¯èª¤å°è‡´ç¶²çµ¡ç™±ç˜“äº†ä¸€æ®µæ™‚é–“)ã€‚ç¾å ´å’Œå¥—æˆ¿é¸æ‰‹é€£æ¥NUCæˆ–è·¯ç”±å™¨å¾Œèƒ½é€æ˜è¨ªå•æ¯”è³½å…§ç¶²ã€‚

kelwinè½‰ç™¼æˆ‘å€‘éƒµä»¶ï¼Œå› çˆ²æ¬¡æ—¥DEFCON 9:00æœƒæœ‰å¾ˆå¤šäººæ’éšŠï¼Œgoonè¨­ç½®äº†ä¸€å€‹å¿«é€Ÿé€šé“ä¾›CTFåƒè³½é¸æ‰‹é€²å…¥Augustus Room(æ¯”è³½ç¾å ´)ã€‚

## 8æœˆ10æ—¥Day 1

ä¸»è¾¦æ–¹å› çˆ²ç¶²çµ¡é…ç½®åŸå› å»¶é²äº†1å€‹å°æ™‚é–‹è³½ã€‚æŠ•å½±çš„å¤§å±å¹•ä¸Šæœ‰æ¯”è³½è¦å‰‡éˆæ¥<http://oooverflow.io/obey>ã€‚é™¤äº†DEFCON CTFæ±ºè³½å‚³çµ±çš„Attack and Defenseé¡å‹é¡Œç›®å¤–é‚„è¨­æœ‰King of the Hill (KoH)é¡å‹é¡Œç›®ã€‚

* Attack and Defenseï¼šæ•…æ„éš±è—æ¼æ´çš„æœå‹™ï¼ŒéšŠä¼éœ€è¦æ‰¾å‡ºæ¼æ´ã€ä¿®è£œæœå‹™(æŠµæ“‹å…¶ä»–éšŠä¼æ”»æ“Šå‰‡ç²å¾—é˜²ç¦¦åˆ†)ã€æ”»æ“Šå…¶ä»–éšŠä¼çš„æœå‹™ç²å¾—flagã€æäº¤flagå¾—åˆ†(æ”»æ“Šåˆ†)
* King of the Hillï¼šæ ¹æ“šè§£çš„è³ªé‡å¾—åˆ†ã€‚ç¬¬ä¸€åæ¯å›åˆç²å¾—10åˆ†ï¼Œç¬¬äºŒåˆ°äº”ååˆ†åˆ¥ç²å¾—6ã€3ã€2ã€1åˆ†ã€‚æˆ‘å€‘æ¨æ¸¬é€™å¯èƒ½æœƒè€ƒå¯«æœ€çŸ­shellcodeã€é”æˆæœ€ä½å»¶é²ç­‰ã€‚

æ¯”è³½æ¯5åˆ†é˜çˆ²ä¸€è¼ªï¼Œæ¯è¼ªæ¯å€‹æœå‹™ï¼Œæ”»æ“ŠæˆåŠŸä¸€å€‹éšŠä¼å¯ä»¥ç²å¾—1æ”»æ“Šåˆ†ï¼Œæ²’æœ‰éšŠä¼æ”»æ“Šæˆæˆ‘æ–¹æœå‹™ç²å¾—1é˜²ç¦¦åˆ†ã€‚ç¸½åˆ†=40%æ”»æ“Šåˆ†+40%é˜²ç¦¦åˆ†+20% KoHåˆ†ã€‚æˆ‘å€‘æ¨æ¸¬æ”»æ“Šåˆ†æœ€é«˜éšŠä¼ç²å¾—400åˆ†ï¼Œå…¶ä»–éšŠä¼æŒ‰ç…§æ¯”ä¾‹å¾—åˆ†ï¼›é˜²ç¦¦åˆ†ã€KoHåˆ†é¡ä¼¼ã€‚

æœå‹™éš¨ç€è¢«åˆ©ç”¨ç¨‹åº¦(èˆ‡èƒ½åˆ©ç”¨çš„éšŠä¼æ•¸ç›®æœ‰é—œ)æœƒè®Šè‰²ï¼šç¶ ã€é»ƒã€æ©™ã€ç´…ï¼Œè®Šæˆç´…è‰²å¾Œå¯èƒ½æœƒä¸‹æ¶æœå‹™ã€‚å› çˆ²æœå‹™å™¨å¸¶å¯¬é™åˆ¶ã€è¨ˆç®—è³‡æºé™åˆ¶(å¾Œä¾†å¾—çŸ¥æœ¬æ¬¡æ¯”è³½ä½¿ç”¨å…©è‡ºæœå‹™å™¨ï¼Œä½†éœ€è¦æœå‹™24æ”¯éšŠä¼)å’Œé‹ç¶­è¤‡é›œæ€§ï¼ŒåŒæ™‚é–‹æ”¾çš„é¡Œç›®ä¸èƒ½å¤ªå¤šã€‚ä»¥å¾€æœå‹™å¾€å¾€è«åå…¶å¦™å°±ä¸‹æ¶äº†ï¼Œé€™æ¬¡æœ‰å€‹é¡è‰²æ¼¸è®Šï¼Œæ˜¯å€‹äº®é»ã€‚

![çµæŸå¾Œçš„portalå€‹é¡Œç›®é¡è‰²](/static/2018-08-13-defcon-26-ctf/final.webp)

èˆ‡DEFCON 21~23 CTF Finalsä¸åŒ(24çˆ²CGCã€25çˆ²cLEMENCyï¼Œéå¸¸è¦å¹³è‡º)ï¼ŒéšŠä¼ä¸èƒ½sshå„è‡ªçš„gameboxæ›¿æ›æœå‹™ï¼Œéœ€è¦é€šéä¸»è¾¦æ–¹æä¾›çš„æ–¹å¼(æ ¹æ“šä¸»è¾¦æ–¹ç™¼æ”¾çš„private keyè¨ªå•github private repoï¼Œå¾Œä¾†æ”¹æˆHTTP POST)patchæœå‹™ã€‚æ¯æ¬¡patchæ™‚ä¸»è¾¦æ–¹æœƒæª¢æŸ¥åˆæ³•æ€§ã€‚å¦‚æœpatchå¾Œå½±éŸ¿åŠŸèƒ½ï¼Œæœƒè¢«revertã€‚

ä¸å…è¨±å¾€å…¶ä»–éšŠä¼æ©Ÿå™¨æ¥å…¥ç¶²ç·šã€‚å¦‚æœç™¼ç¾é€™é¡ä¸æ­£ç•¶è¡Œçˆ²ï¼Œå¯èƒ½æœƒè¢«é•·æœŸban(>1å¹´)ä¸èƒ½å‚åŠ æ¯”èµ›ã€‚

![portal](/static/2018-08-13-defcon-26-ctf/portal.webp)

äº’è¯ç¶²å’Œæ¯”è³½å…§ç¶²ä½¿ç”¨åŒä¸€æ ¹ç¶²ç·šï¼Œä½†ä»Šå¹´ä¸»è¾¦æ–¹æ²’æœ‰ä½¿ç”¨VLANéš”é›¢ã€‚riatreå’Œæˆ‘9:00åˆ°é”ç¾å ´ï¼Œç¨æ™š6äººå’Œæˆ‘å€‘åŒ¯åˆ

å…¥å ´å¾Œç™¼ç¾ç¶²çµ¡ä¸é€šã€‚å› çˆ²ç¶²çµ¡å•é¡Œä¸»è¾¦æ–¹æ¨é²åˆ°äº†11:00ã€‚æœ€æ—©é–‹æ”¾çš„é¡Œç›®æ˜¯King of the Hillé¡å‹çš„reverseã€‚æ¯è¼ªæ¯æ”¯éšŠä¼æœ‰12æšcoinsï¼ŒæŠ•æ”¾ä¸€æšcoinå¯ä»¥ç©ä¸€æ¬¡ï¼Œæ˜¯å€‹x86-32 x86-64çš„disassembleé¸æ“‡é¡ŒéŠæˆ²ï¼ŒçŒœæŒ‡ä»¤ã€æŒ‡ä»¤åœ°å€ç­‰ã€‚æœ‰éšŠä¼å…ˆç©åˆ°äº†90åˆ†ï¼Œæˆ‘é€šér2/pwntools disassembleå¯ä»¥ç©åˆ°100å¤šåˆ†ï¼Œä½†ä¸ä¹…å°±æœ‰éšŠä¼ç ”è£½å‡ºè‡ªå‹•åŒ–å¯ä»¥å¼„åˆ°600å¤šåˆ†ã€‚æœå‹™ç«¯ç¨‹åºæ˜é¡¯æœ‰bugï¼Œæœ‰æ™‚æœƒæœ‰é‡è¤‡é¸é …ï¼Œæœ‰æ™‚æœƒæœ‰éŒ¯èª¤é¸é …ã€‚
```
We are at level 4
Time remaining: 60, score: 1960
Lines:
    0x8465eae:                    mov     ecx, dword [edx]
    0x8465eb0:                    mov     edx, dword [edx+0x4]
    ?????????:                    cmp     edx, 0xfffffffa
    0x8465eb6:                    je      0x8466010

    0xba9fb: 4889740??8         mov     qword [rdx+rcx+0x8], rsi
Choices (4):
    0. '0x8465eb5\x003 b8 35 '
    1. '0x8465eb3\x00b 57 64 \x00[esp+0x1c ]'
    2. '0x8465eb2\x009 70 a0 \x00x10ef51]'
    3. '0x8465eb7\x009 c8 cf '
    4. '0x8465eaf\x00f 11 b2 '
I think the answer is: 0x8465eb4
Cannot solve: no solution?. Saving...
```
è³½å¾ŒFish Wangå‘Šè¨´æˆ‘æ‡‰è©²ç¹¼çºŒé€†å‘ï¼Œä¿®å¾©ç¨‹åºçš„åŠŸèƒ½ï¼Œåˆ©ç”¨éš±è—æŒ‡ä»¤ç°¡åŒ–éŠæˆ²ï¼Œä¸éœ€è¦å¤§åŠ›æŠ•å…¥åˆ°å®Œæ•´çš„solverä¸Šã€‚

BrieflyXæ ¹æ“šä¸»è¾¦æ–¹æä¾›çš„`game_states.json`ç°¡å–®è™•ç†äº†ä¸‹åšäº†å€‹å…§ç¶²portalã€‚æˆ‘ç”¨`display: grid;`ç¨å¾®æ”¹äº†æ”¹ã€‚

æ–°é¡Œpointless
```
Description: pointless. Flag location /flag. You may patch up to 200 bytes in the pointless binary.
```
è§£å‹ä¸‹è½½çš„`pointless.tgz`åæœ‰32ä½`EM_MIPS`ç¨‹åºï¼Œæä¾›äº†MIPSçš„`/usr/lib/` `/lib/`ï¼Œå¯ä»¥ç”¨qemu-mipsåŸ·è¡Œã€‚æˆ‘å€‘ç™¼ç¾ç”¨ä¸€äº›æ–°qemu-user(å¦‚2.12)é‹è¡Œæ™‚æœƒåœ¨`<code_gen_buffer+154742>:     movbe  ebp,DWORD PTR gs:[ebp+0x0]`è™•SIGSEGVã€‚

16:20ç™¼ç¾æ–°é¡Œtwoplustwoï¼Œæ²’æœ‰stripï¼Œéˆæ¥äº†`libjemalloc.so.1`ã€‚
```
Description: A very shy calculator. Flag location is /flag, and you may patch up to 24 bytes in the twoplustwo binary.
Your IP: 10.13.37.22
Port: 6969
Type: NORMAL
```

```
% ./twoplustwo
welcome to the ooo approved calculation.app
approved functionality is limited to printing a duck, repeating a string, adding numbers, multiplying numbers, concatinating strings, exiting, and replacing a single character in your name
any unapproved use of this application is not permitted and will be dealt with swiftly

OOORPC_HELLO(),2: OOORPC_REPEAT_STRING(string, num_times), 3: OOORPC_ADD_NUMBERS(num1, num2), 4: OOORPC_MULTIPLY_NUMBERS(num1, num2), 5: OOORPC_CONCAT_STRINGS(string1, string1), 6: OOORPC_FIND_REPLACE(needle, replace), 7: OOORPC_EXIT(message)
base64([functionidx]\x00[arg?]\x00[arg?]...[yourname])
```

17:00 reverseèƒ½åšlevel 7äº†ã€€
17:10 DEFKOR00T first blood twoplustwoã€‚ä¹‹å¾ŒSauercloud A\*0\Eä¹Ÿèƒ½æ”»æ“Šäº†ã€‚
17:30åˆ°äº†23200åˆ†ï¼Œä½†ä»ç„¶æ˜¯ç¬¬ä¸‰
Congratulations, you have quite some skills
you have anything to say in your defense?
It was pure luck, I do not deserve this

PPPå¯ä»¥å…¨å ´æ‰“pointlessã€‚

19:50é–‹æ”¾æ–°é¡ŒKoHé¡å‹é¡Œç›®doublethinkï¼ŒåŒæ™‚åŸä¾†çš„reverseè¢«é—œé–‰ï¼š
```
Description: How many conflicting ideas can you hold in one thought? Files available at oooverflow.io/obey/doublethink.tar.gz.
Your IP: 10.13.37.22
Port: 9318
Type: KING_OF_THE_HILL
```
é€™é¡Œå¾ˆæœ‰è¶£ï¼Œpolyglot shellcodeã€‚
* åœ¨ç¾ä»£æ¶æ§‹(arm64ã€amd64ã€mipsel)ä¸Šé¸ä¸€ï¼Œæ”»æ“ŠæˆåŠŸå¾Œ
* åœ¨[SimH](http://simh.trailing-edge.com)æ”¯æŒçš„è‹¥å¹²å¤ä»£æ¶æ§‹ä¸Šé¸ä¸€ï¼Œæ”»æ“ŠæˆåŠŸå¾Œ
* å¯ä»¥ä»»æ„é¸æ“‡å°šæœªæ”»æ“Šçš„å¤ä»£æ¶æ§‹æˆ–â€œæœªä¾†â€æ¶æ§‹ï¼ŒæŒçºŒè©²éç¨‹ç›´åˆ°æ”»æ“Šå®Œæ‰€æœ‰æ¶æ§‹æˆ–ç„¡æ³•æ”»æ“ŠæˆåŠŸ

å¯é¸æ¶æ§‹ï¼š
```python
available = {
	'past': { 'lgp-30', 'pdp-1', 'pdp-8', 'pdp-10', 'mix', 'ibm-1401', 'nova' },
	'present': { 'amd64', 'arm64', 'mipsel' },
	'future': { 'risc-v', 'hexagon', 'mmix', 'clemency' }
}
all_available = set.union(*available.values())
max_control = len(available['past']) + len(available['future']) + 1
```

å°æ–¼æ”¯æŒè®€å–æ–‡ä»¶çš„æ¶æ§‹ï¼Œæœƒåœ¨å›ºå®šåœ°å€è®€å…¥ä½ çš„shellcodeä¸¦åŸ·è¡Œï¼š
```c
void *mem = mmap((void *)address, 0x4000, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANON, 0, 0);
printf("Reading file into %p...\n", mem);
int read_bytes = fread(mem, 1, max_size, shellcode_file);
printf("Loaded %d bytes of shellcode at %p (tried for %p)...\n", read_bytes, mem, (void *)address);

printf("Executing!\n");

((void(*)())mem)();
```

å°æ–¼SimHæ”¯æŒçš„æ¨¡æ“¬å™¨ï¼Œæ¯”å¦‚pdp-1ï¼Œåœ¨æ©Ÿå™¨å­—0è™•è®€å…¥flagï¼Œæ©Ÿå™¨å­—64è™•ç”¨depositå¡«å…¥ç¨‹åºï¼Œåœ¨64è™•æ¨¡æ“¬é‹è¡Œã€‚shellcodeèƒ½æ‰“å°è™•flagçš„å­—ä¸²å³å¯ã€‚
```
% ./drive_emu.py pdp-1 flag shellcode
d 0100 356424
d 0101 760200
d 0102 200001
...
d 0 "ooo"
d 01 "fla"
d 02 "g  "
run 100
exit
```

æ€è·¯æ˜¯å¦‚ä¸‹ç·¨æ’æŒ‡ä»¤ï¼š

* æ¶æ§‹0çš„jmpæŒ‡ä»¤ï¼Œåœ¨æ¶æ§‹1~n-1ä¸Šèƒ½å®‰å…¨åŸ·è¡Œ(é¡NOP)
* æ¶æ§‹1çš„jmpæŒ‡ä»¤ï¼Œåœ¨æ¶æ§‹2~n-1ä¸Šèƒ½å®‰å…¨åŸ·è¡Œ(é¡NOP)
* æ¶æ§‹2çš„jmpæŒ‡ä»¤ï¼Œåœ¨æ¶æ§‹3~n-1ä¸Šèƒ½å®‰å…¨åŸ·è¡Œ(é¡NOP)
* â€¦â€¦
* æ¶æ§‹0çš„shellcode
* æ¶æ§‹1çš„shellcode
* æ¶æ§‹2çš„shellcodeã€‚nå€‹æ¶æ§‹çš„shellcodeé–“é †åºç„¡é—œç·Šè¦

ä½†æ˜¯æŸ¥æ‰¾æ»¿è¶³çš„è¦æ±‚çš„jmpæŒ‡ä»¤å¾ˆå›°é›£ã€‚å¤§å®¶æœé›†å„å€‹å¤è€æ¶æ§‹çš„æ‰‹å†Šã€å½™ç·¨å™¨ï¼š

* GNU MIX Development Kit
* LLVM+Clangï¼Œå¯ä»¥ç”¨ä¾†è™•ç†amd64ã€arm64ã€mipselã€hexagonã€risc-v
* SimHä¸­çš„lgpè™•ç†lgp-30ï¼Œmacro1è™•ç†pdp-1
* â€¦â€¦

20:00 Day 1çµæŸã€‚oooverflowçš„zarduså¬é›†å„å€‹éšŠä¼çš„éšŠé•·é–‹æœƒã€‚

å¾Œä¾†å¾—çŸ¥å¾ˆå¤šéšŠä¼ç™¼ç¾30000/tcpå¯ä»¥è¨ªå•â€œDC 26 Admin Interfaceâ€ï¼Œåˆæ˜¯ä¸€å€‹ä¸»è¾¦æ–¹çš„bugã€‚æ¨æ¸¬é€šégit repo(ç”¨æ–¼ä¸Šå‚³patch)å¯ä»¥ä¸‹è¼‰åˆ°é¡Œç›®ï¼Œä½†å¥½åœ¨git repoä¹Ÿæ›äº†ï¼Œæ‰æ²’æœ‰æå‰æ³„æ¼é¡Œç›®ã€‚

## 8æœˆ11æ—¥Day 2

9:00å…¥å ´10:00é–‹è³½ï¼Œä½†ä¸»è¾¦æ–¹å› çˆ²ç¶²çµ¡å•é¡Œæ¨é²åˆ°äº†å¤§ç´„12:20ã€‚

åœ¨åŒ—äº¬é ç¨‹åƒèˆ‡çš„f1yyyç ”è£½å‡ºäº†amd64+pdp-1 shellcodeï¼Œå¯æƒœæ²’æœ‰æ´¾ä¸Šç”¨å ´ã€‚å¾ˆå¤šéšŠä¼éƒ½èƒ½æ”»æ“Š3ã€4å€‹æ¶æ§‹ï¼ŒPPPæœ‰æ”»æ“Š5å€‹éšŠä¼çš„polyglot shellcodeã€‚Dragon Sectorç”šè‡³æœ‰9å€‹ï¼Œå¾Œä¾†çœ‹åˆ°HITCONæœ‰11å€‹(amd64 pdp10 pdp8 pdp1 nova mix mmix ibm1401 lgp30 risc-v hexagon)ã€‚Dragon Sectorçš„ä¸€åº¦è¢«ä¸»è¾¦æ–¹æŸ¥å°ï¼Œä½†å¾Œä¾†æ¢å¾©ã€‚æ‡‰è©²æ˜¯åˆ©ç”¨äº†é¡Œç›®æ¼æ´(å„å€‹æ¶æ§‹å…±ç”¨åŒä¸€å€‹flagã€æ²’æœ‰sandboxéš”é›¢å…©å€‹ä½µç™¼çš„é€£æ¥)ï¼Œç”±ä¸€å€‹amd64é€£æ¥è®€åˆ°çš„flagå¾€å¦ä¸€å€‹é€²ç¨‹çš„æ¨¡æ“¬å™¨é€²ç¨‹å¯«stdinæˆ–stdoutï¼Œå¾Œä¾†èˆ‡ä¸»è¾¦æ–¹äº¤æ¶‰å¾Œåˆ¤ä½œåˆæ³•äº†ã€‚è³½å¾Œè¨˜è€…å•zardusè‡ªå·±æœ‰æ²’æœ‰è©¦éèƒ½æ‰“å¤šå°‘æ¶æ§‹ï¼Œä»–å·§å¦™åœ°é¿é–‹äº†é€™å€‹è©±é¡Œï¼Œå›ç­”èªªæ¯å€‹æ¶æ§‹éƒ½è©¦éèƒ½æ‰“ã€‚(ä½†æ˜¯çµ„åˆèµ·ä¾†å°±ä¸çŸ¥é“äº†ï¼ŒPPPçš„éæ¼æ´æ­£å®—5å€‹æ¶æ§‹å¾ˆæ£’)

12:40çœ‹èµ·ä¾†æˆ‘å€‘çš„twoplustwoè£œå¥½äº†ï¼Œ Dragon Sectorã€PwnThyBytesã€koreanbadassã€r3kapigã€pastenã€Spaceballsä¼¼ä¹æ²’è£œå­—ç¯€ç¢¼æ³¨å…¥ã€‚
13:00ç™¼ç¾æ–°é¡Œoooeditor
```
Description: The vim vs emacs religious war finally comes to an end. The Order has mandated the use of OOO Editor. Flag location is /flag, and you may patch up to 10 bytes in the oooeditor binary. The binary is available from oooverflow.io/obey/oooeditor
Your IP: 10.13.37.22
Port: 8297
Type: NORMAL
```
é€™æ˜¯ä¸€å€‹é…·ä¼¼radare2çš„æœå‹™ï¼Œå¹¾ä¹å¯ä»¥è‚¯å®šæ˜¯defcon.orgå®˜æ–¹ç¶²ç«™ä»‹ç´¹é é¢çš„lzcnt ("one of the principal developers of the radare2 binary analysis framework")å‡ºçš„ã€‚

å¦‚æœæ˜¯éUbuntu 18.04çš„Debianç³»ç’°å¢ƒï¼Œæ²’æœ‰libgnustep-base1.25ï¼Œå¯ä»¥`r2 oooeditor -wqc 'w 4 @ 0x4009a7'`æŠŠ`DT_NEEDED`å­—æ®µpatchæˆ1.24é‹è¡Œã€‚
```
% ./oooeditor
[0x00000000]> ls
a.png   b.jpg   c.elf
d.bz2
[0x00000000]> o a.png
[0x00000000]> p 4
61 2E 70 6E                                       |  a.pn
[0x00000000]> p 4 @ 2
70 6E 67 68                                       |  pngh
[0x00000000]>
```
é€™å€‹æœå‹™ç”¨GNU Objective-Cç·¨è­¯ï¼Œéˆæ¥äº†GNUStepï¼Œå¤§å®¶éƒ½ä¸ç­è§£é€™å€‹ã€‚åœ¨åŒ—äº¬é ç¨‹åƒèˆ‡çš„hankein95æ¨è–¦æˆ‘å€‘é–±è®€<http://phrack.org/issues/66/4.html>ã€‚

æˆ‘å€‘å¾ˆå¿«æ³¨æ„åˆ°äº†out-of-bound read/writeã€‚

15:08 PPP first bloodã€‚15:17ç™¼ç¾é‚„æ²’æœ‰äººä¿®è£œoooeditorï¼Œæˆ‘å°±ç”¨r2ä¿®è£œäº†ä¸€ä¸‹ï¼š
```objc
if ((signed int64_t)file_size > offset)
  file_contents[pos] = byte;
```
è™•çš„-Wsign-compareå•é¡Œã€‚

16:20å‡ºç°æ–°é¢˜pooolï¼Œæ··å…¥äº†å€å¡Šéˆå…ƒç´ ï¼ŒæŒ–ç¤¦è³ºéŒ¢å…Œæ›flagï¼š
```
poool
Description: pay per share stratum mining pool. You may patch the poool binary. Each team may only submit 5 patches. Choose wisely. Flag location /flag. Flag format: 000[A-F0-9]{45}. Files available at oooverflow.io/obey/poool.tgz.
Your IP: 10.13.37.22
Port: 10001
```
è³½å¾Œslipperèªªï¼š

* ä¸åˆ©ç”¨æ¼æ´ï¼Œç‡’éŒ¢é–‹æœå‹™å™¨ç”¨4096æ ¸å¯ä»¥å…Œæ›åˆ°flag
* æœ‰å€‹type confusionæ¼æ´
* æœ‰å€‹-Wsign-compareæ¼æ´ï¼Œå¯ä»¥ç›´æ¥æ‹¿flag
* ç”¨scanfè®€å–nonceï¼Œå¯ä»¥ç®—ä¸€æ¬¡æäº¤å¾ˆå¤šé

å¤§ç´„æœ‰åŠå°æ™‚å¥—æˆ¿å…§æ¥µè·¯ç”±å’Œæœ‰ç·šç¶²æ–·é–‹äº†ã€‚
![æ¥µè·¯ç”±ç¶²çµ¡è¨ºæ–·](/static/2018-08-13-defcon-26-ctf/gee.webp)

æˆ‘å€‘èƒ½æ”»æ“ŠPwnThyBytesçš„oooeditorã€‚

18:20å‡ºç¾æ–°é¡Œbewã€‚æ˜¯ä½¿ç”¨Node.jsæ¡†æ¶Express.jsçš„webæœå‹™(åœ¨DEFCON CTF Finalsä¸Šéå¸¸ç½•è¦‹ï¼Œå‚³çµ±ä¸Šåªè€ƒç¡¬æ ¸çš„äºŒé€²åˆ¶æ”»é˜²)ã€‚
```
Description: Finally the Thought-CyberCrimes Reporting System is up and running. Report your suspects now, because in the new era even thinking about a cybercrime is punishable. You may patch the express-validator.wasm file. Flag location /flag, and you may patch up to 1024 bytes. Download the service from oooverflow.io/obey/bew.tar.gz
Your IP: 10.13.37.22
Port: 5080
Type: NORMAL
```

* è£é¢ç”¨çš„`node_modules/express-validator`å’Œå¯¦éš›1.0.0ç‰ˆæœ¬ä¸åŒï¼Œå¤šäº†wasmæ¨¡å¡Š`node_modules/express-validator/express-validator.wasm`ï¼Œ`index.js`ä¹Ÿæœ‰å¾ˆå¤šé›†æˆwasmåˆ°jsçš„ä»£ç¢¼ã€‚
* `routes/data.js`(`/report`)å¯ä»¥å¯«å…¥`public/suspects.txt`
* `routes/suspects.js`(`/suspects`)æœƒè®€å–`public/suspects.txt`

æˆ‘å€‘æŠŠä¸‰å€‹webæ‰‹å–šé†’ã€‚å¤§å®¶ä½¿ç”¨[wabt](https://github.com/WebAssembly/wabt)ç­‰å·¥å…·åˆ†æã€‚Day 2çµæŸå¾Œå˜—è©¦äº†å„ç¨®web application firewallé‚è¼¯æª¢æ¸¬æƒ¡æ„ä»£ç¢¼åŸ·è¡Œã€‚

18:00å¤šä¼¼ä¹æ‰€æœ‰éšŠä¼çš„oooeditoréƒ½ä¿®è£œäº†ã€‚
19:00ä¸»è¾¦æ–¹å®£ä½ˆoooeditoræœ‰pcapäº†(å¯¦éš›ä¸Šå·²ç¶“æ²’æœ‰ç”¨äº†)
19:15ä¸»è¾¦æ–¹å®£ä½ˆDEFKOR00T first bloodäº†pooolã€‚å¾Œä¾†å¾—çŸ¥ä»–å€‘é€™å¤©å°±åˆ©ç”¨äº†pooolçš„å…©å€‹æ¼æ´ã€‚
19:20å®£ä½ˆæ¯å€‹éšŠä¼ä»Šå¤©åªèƒ½ä¿®è£œå…©æ¬¡ï¼ŒåŸå› æ˜¯stratum miningå¾ˆè€—è³‡æº(å¾Œä¾†å¾—çŸ¥å‘½é¡Œäººslipperæœ‰å€‹åœ¨HTå¾Œ96æ ¸ç³»çµ±ä¸Šé‹è¡Œ2 3åˆ†é˜çš„è§£æ³•ï¼Œè€Œä¸€è¼ªæ™‚é–“åƒ…çˆ²5åˆ†é˜)
19:27ç™¼ç¾PwnThyBytesæ”»æ“ŠTokyoWesternsçš„bewç²å–äº†first bloodã€‚å¾ˆå¿«koreanbadasså’Œmhackeroniä¹Ÿèƒ½æ”»æ“Šé€™å€‹æœå‹™ã€‚

å› çˆ²é–‹è³½æµªè²»äº†å…©å€‹å°æ™‚ï¼Œä¸»è¾¦æ–¹æŠŠä»Šæ—¥æ¯”è³½å¾20:00å»¶é•·åˆ°21:00ã€‚

20:30å‡ºç¾æ–°é¡Œvchatï¼Œæ˜¯å€‹ä½¿ç”¨[gloox](https://camaya.net/gloox)çš„XMPP clientã€‚
```
Description: The Order of the Overflow has assigned you a personal virtual assistant. Obey the assistant. You may patch up to 100 bytes in the vbot binary. Files available at oooverflow.io/obey/vchat.tgz **AND AT oooverflow.io/obey/vchat-hint.tgz**. This is a client-server service. The Order runs the *client* on your vulnerable image (on port 2555); the server is on port 5222.
Your IP: 10.13.37.22
Port: 2555
Type: NORMAL
```

21:00ä¸»è¾¦æ–¹å¬é›†å„å€‹éšŠä¼çš„éšŠé•·é–‹æœƒã€‚zardusæåˆ°äº†ä¸€äº›å•é¡Œï¼š

* é–‹è³½æ¨é²
* pointlessæœå‹™çš„å•é¡Œã€‚ä¸éé€™å€‹åå­—èµ·å¾—ä¸éŒ¯ï¼Œæ©é£¾/è§£é‡Šäº†é€™å€‹æœå‹™çš„è¡†å¤šå•é¡Œã€‚
* ç”¨æ–¼ä¸Šå‚³patchçš„gitæœå‹™çš„å¯é æ€§ã€‚ç¬¬ä¸€å¤©çµæŸå¾Œé€£å¤œè¶•åšäº†portalé é¢æäº¤patchçš„åŠŸèƒ½ã€‚
* é˜²ç¦¦åˆ†è¨ˆç®—bugã€‚æ¯è¼ªæ¯å€‹æœå‹™æ²’è¢«æ”»æ“Šå³å¯å¾—åˆ†ï¼Œä½†å› çˆ²ä¸€å€‹bugå°è‡´æ¯å€‹æœå‹™éƒ½æ²’è¢«æ”»æ“Šæ‰å¾—åˆ†ï¼Œæœƒä¿®å¾©ã€‚
  ```diff
  - was_service_exploited[service.id] = True
  + was_service_exploited[event.service.id] = True
  ```
* æ‡‰è©²é‚„æœ‰ä¸€äº›ï¼Œä½†æˆ‘è¨˜ä¸èµ·ä¾†äº†

æˆ‘å¾Œä¾†é…ç½®äº†ä¸€ä¸‹XMPP server prosodyï¼Œä¸æ‡‚XMPPï¼Œç™¼ç¾å¾ˆé›£å’Œvboté€šä¿¡ï¼Œä¸çŸ¥é“æ€éº¼æŠŠanonymousæ¨¡å¼å’Œstarttlsèª¿å¥½ï¼Œå€’æ˜¯ç™¼ç¾ä¸€å€‹XMPP client [profanity](http://www.profanity.im)é«˜ä»¿irssi/weechatï¼Œçœ‹èµ·ä¾†è³å¿ƒæ‚…ç›®ã€‚å¾Œä¾†BrieflyXå¼„å‡ºä¸€å€‹è‡ªè£½ç°¡æ˜“serverå¯ä»¥èˆ‡vboté€šä¿¡äº†ï¼Œä½†è¡†äººçœ‹ä¸å‡ºæ¼æ´ã€‚è³½å¾ŒçŸ¥é“gloox cacheå¯ä»¥å°è‡´use-after-freeã€‚

## 8æœˆ12æ—¥Day 3

2:34 f1yyyèªªpooolå¯ä»¥å †ä»»æ„è®€äº†ï¼Œ6:00å¤šèªªå¯ä»¥è®€flagäº†ã€‚

10:00æ¯”è³½é–‹å§‹ï¼ŒæŒ‰ç…§æ…£ä¾‹ï¼Œçˆ²äº†ç•™æ‡¸å¿µï¼Œä»Šå¤©ä¸å±•ç¤ºç©åˆ†æ¦œï¼Œä½†ä»ç„¶èƒ½çœ‹åˆ°exploitation eventsã€‚pooolçš„patchæ¬¡æ•¸å–æ¶ˆäº†ã€‚æˆ‘å€‘ç™¼ç¾æ²’æœ‰éšŠä¼èƒ½åˆ©ç”¨vchatã€‚ä¸»è¾¦æ–¹çµ¦äº†vchatçš„æç¤ºï¼Œæœå‹™ç«¯é…ç½®æ˜¯ejabberd SASL ANONYMOUSã€‚

bewä¸»åŠæ–¹æŠŠæƒé™é…ç½®é”™è¯¯äº†ï¼Œæœ‰ä¸ªé˜Ÿä¼æŠŠå…¶ä»–é˜Ÿä¼çš„æ–‡ä»¶æ”¹äº†ï¼Œä¹Ÿæœ‰Denial of Serviceå•é¡Œã€‚å¤§ç´„12:00ä¸»è¾¦æ–¹é—œé–‰äº†bewã€‚æˆ‘å€‘ç ”è£½çš„è‹¥å¹²å€‹bew exploitæµªè²»äº†ã€‚æˆ‘å€‘çš„ä¿®å¾©ä¹Ÿç„¡æ•ˆ`TOO_MANY_BYTES`ï¼Œcxm wupcoåœ¨ä¿®å¾©æ™‚å·æ‡¶å¯„å¸Œæœ›æ–¼ä¸»è¾¦æ–¹ä½¿ç”¨edit distanceåˆ¤æ–·å­—ç¯€é™åˆ¶ï¼Œå¾ˆå¯æƒœã€‚

ç™¼ç¾æ–°é¡Œreeducationï¼Œæ˜¯å€‹å¸¶ç¬¦è™Ÿå’Œèª¿è©¦ä¿¡æ¯çš„RuståŸ·è¡Œæª”ã€‚
```
Description: You have arrived at the OOO re-education center. You may patch up to 16 bytes in the reeducation binary, available at oooverflow.io/obey/reeducation.
Your IP: 10.13.37.22
Port: 1221
Type: NORMAL
```

f1yyyçš„poool exploitå¯ä»¥æ”»æ“Š17å€‹éšŠä¼ã€‚å¾Œä¾†ç™¼ç¾æœ‰å€‹`if ((signed __int64)tmp <= 0x1FFFFFFFFFFLL)` bugï¼Œå¯ä»¥åŠ å¾ˆå¤šéŒ¢ï¼Œå¾ˆå¤šå…¶ä»–éšŠä¼åˆ©ç”¨äº†é€™å€‹ã€‚

11:15ç™¼ç¾æ–°King of the Hillé¡Œpropagandaã€‚ç”¨ncé€£æ¥å¾Œé¡¯ç¤ºå¯ä»¥ä¸Šå‚³ä¸‹è¼‰æœå‹™ã€‚ä¸èƒ½ç”¨telneté€£æ¥ï¼Œå¦‚æœç™¼é€`1\r\n`æœƒè¢«æ‹’çµ•è«‹æ±‚ã€‚
![](/static/2018-08-13-defcon-26-ctf/propaganda.webp)

```
% ./propaganda 1

 Order through Control.

 -------[ OOO Stamp ]------
 |      .  . *.           |
 |     * .  +             |
 |    . E    * .          |
 |       .    * *         |
 |      * .    +          |
 |     * *    S .         |
 |    . .  . . * *        |
 |       .. .   . .       |
 |        .+*             |
 |         *x+            |
 --------------------------
```

ç”¨é¸é …1ä¸‹è¼‰åŸ·è¡Œæª”å¾Œç™¼ç¾é€™å€‹ç¨‹åºæŠŠå‘½ä»¤è¡Œåƒæ•¸ã€.text .finiå’Œ.rodataå¤§éƒ¨åˆ†è¨ˆç®—MD5å¾Œé¡¯ç¤ºçˆ²randomartã€‚å¦‚æœç¯¡æ”¹ç¨‹åºï¼Œæ”¹è®Šè¼¸å‡ºçš„å­—ä¸²`Order through Control`ï¼Œå°±æœƒç ´å£randomartã€‚æœ‰å…©ç¨®æ€è·¯ï¼š

* ä¿®æ”¹.textï¼Œè¨­æ³•ä¿®å¾©hash
* ä¿®æ”¹`__printf_chk`çš„PLTé …ï¼Œè·³è½‰åˆ°.eh_frameã€‚æˆ‘å€‘é¸æ“‡äº†é€™ç¨®ï¼Œhooké€™å€‹å‡½æ•¸å¾Œç”¨`rsi-8!=rsp`ã€`format[0] != 'O'`ç­‰æ–¹å¼æª¢æ¸¬æ˜¯ç¬¬å¹¾å€‹printfèª¿ç”¨ï¼Œç™¼ç¾è¦è¼¸å‡º`Order through Control`å‰‡æ›¿æ›å­—ä¸²ã€‚riatreå«ºç†Ÿåœ°patchäº†äº¤äº†ä¸€å€‹ç‰ˆæœ¬ä¸Šå»ï¼Œæ’åˆ°ç¬¬äº”ï¼Œä¹‹å¾Œåˆå„ªåŒ–äº†ä¸‹ã€‚æˆ‘ç™¼ç¾äº†r2 `waf`çš„å¹¾è™•å•é¡Œã€‚
![](/static/2018-08-13-defcon-26-ctf/day3.webp)

```
# a solution of 45 bytes
# a.r2
wa jmp 0x1920 @ sym.imp.__printf_chk
wa call 0x193a @ 0x1920
wz ORDER OF OBEDIENCE.\n @ 0x1925
waf a.asm @ 0x193a

# a.asm
pop rax
cmp byte [rsp], 0x2b  # if return address of the __printf_chk call is what we want to hack
cmovz rsi,rax
jmp [0x201fb8]

# shell
r2 -e 'asm.assembler=x86.ks' -wqi a.r2 propaganda
```

14:00æ¯”è³½çµæŸï¼Œæˆ‘å»äº†ç¾å ´ï¼Œå’Œriatreã€mistyæ‰¾å…¶ä»–éšŠä¼èŠå¤©ï¼Œé †ä¾¿æ¨éŠ·cclsã€‚æ¯”è¼ƒå¯æƒœçš„æ˜¯å¤§éƒ¨åˆ†A\*0\*Eé¸æ‰‹éƒ½æ²’è¦‹åˆ°ï¼Œåªçœ‹åˆ°äº†Azure (eee)ã€‚ ä»–æåˆ°ä¸»è¾¦æ–¹æäº¤flagä¹Ÿæœ‰bugï¼Œæœ‰çš„æ™‚å€™æäº¤åŒæ¨£flagæœƒéƒ½é¡¯ç¤ºAcceptï¼Œç¬¬ä¸€æ¬¡æäº¤å¯¦è³ªä¸Šæ²’æœ‰è¨ˆåˆ†ï¼Œå¯èƒ½æ˜¯å› çˆ²æ¯è¼ªflagæ¨é€çš„åŒæ­¥å•é¡Œå°è‡´çš„ã€‚Mistyé–‹å¿ƒåœ°åŠ æ—¥æœ¬äººå¾®ä¿¡ã€‚è¦‹åˆ°äº†HITCONå’ŒBFSå¹¾ä½éšŠå“¡ã€‚iromiseå’Œé™³ä»²å¯¬(æˆ‘æ²’æœ‰èªå‡ºä¾†QAQ)è¨è«–è³‡å®‰ç¤¾åœ˜æ‹›æ–°é›£çš„è©±é¡Œã€‚

æ··å…¥äº†r3kapigçš„Atumçš„é›†é«”ç…§
![](/static/2018-08-13-defcon-26-ctf/team.jpg)

16:30 DEFCONé–‰å¹•å¼ï¼ŒæŒ‰ç…§æ…£ä¾‹æœ€å¾Œæœƒå®£ä½ˆDEFCON CTFå‰ä¸‰åã€‚ä½†æˆ‘å€‘å»å¾—å¤ªæ™šï¼Œè¢«goonå¼•å°åˆ°Track 3ï¼Œå¾Œä¾†è¢«å‘ŠçŸ¥"sorry"ï¼Œåªå¥½å›å¥—æˆ¿çœ‹é›»è¦–ä¸Šçš„dctv (DEF CON TV)ã€‚å¾€å¹´æˆ‘å€‘éƒ½å¿½ç•¥äº†dctvï¼Œä»Šå¹´dctvæˆçˆ²DEFCONä¸€å€‹æ–°çš„ éƒ¨é–€ï¼Œåœ¨å…­å€‹é…’åº—æ’­å‡ºï¼šCaesarsã€Flamingoã€Parisã€Bally'sã€Harrah'sã€‚ä¸€äº›ç¶²çµ¡è¨­å‚™ç”¨äº†FreeBSDï¼Œä½†ä¸»è¾¦æ–¹çš„ç©ç¬‘(æ¯”è³½çªç„¶è®ŠæˆFreeBSD+ipv6)ä¸¦æ²’æœ‰ç™¼ç”Ÿã€‚DEFCON 27å°‡æœƒåœ¨Parisã€Bally'så’ŒPlanet Hollywoodä¸‰åœ°åˆ†ä½ˆå¼é‹è¡Œã€‚DEF CON Chinaå°‡ç¹¼çºŒèˆ‰è¾¦ã€‚

![](/static/2018-08-13-defcon-26-ctf/oooverflow.webp)
ç„¡æ„ä¸­æˆªåˆ°é€™å¼µåœ–ï¼Œåªæœ‰slipperæœ‰è‰¯å¥½çš„â€œèªç½ªâ€æ…‹åº¦ï¼Œå…¶ä»–äººæ€éº¼å¬‰çš®ç¬‘è‡‰â€¦â€¦

Tea Deliverersç¬¬6åã€‚
![](/static/2018-08-13-defcon-26-ctf/rank.webp)

BrieflyXç¸½çµèªªï¼Œä»Šå¹´æ¯å¤©éƒ½å¾ˆå›°ï¼Œä¸éå¥½çš„æ–¹é¢æ˜¯ç¶²çµ¡æ²’æœ‰å‡ºå¤§å•é¡Œã€‚æ™šä¸Šæˆ‘å€‘åœ¨Joes Seafood Prime Steak & Stone Crabåƒé£¯ã€‚

21:00å¤šæ®µè€å¸«å’Œåˆ˜ä¿å›çµ¦æˆ‘å€‘é“åˆ¥ï¼Œè¦å»è¶•USENIX Security'18äº†ã€‚æ„Ÿè¬ä»–å€‘é€™å¹¾å¤©æä¾›çš„å¾Œå‹¤ä¿éšœï¼

23:20 scateuä¾†æ¢æœ›æˆ‘å€‘ï¼Œæ¥è¦‹äº†å¹¾ä½æ¸…è¯å¤§å­¸å­¸ç”Ÿç¶²çµ¡å®‰å…¨æŠ€è¡“å”æœƒåŒå­¸ï¼Œä»‹ç´¹äº†ä»–åœ¨Blackhatä¸Šçš„æ¼”è¬›ï¼Œåˆ†äº«äº†ä¸€äº›æ®µå­ï¼Œçµ¦æˆ‘å€‘å¸¶äº†å¹¾å€‹ASRCçš„éª°å­ï¼Œè«‡è«–æ¸…è¯å¤§å­¸çš„ä¿®è»Šé‹ªå’Œå°è³£é‹ªï¼Œè«‡è«–è‡ªå·±æœªä¾†å®‰å…¨ç ”ç©¶çš„å±•æœ›ï¼Œæš¢è«‡åˆ°è¿‘1:00æ‰å›å»ã€‚

## 8æœˆ13æ—¥

æ—©ä¸Šåƒäº†å…©å€‹HITCONé€çš„é³³æ¢¨é…¥ä½œçˆ²æ—©é£¯(æ„Ÿè¬ï½æ˜¨å¤©ä¸‹åˆé€çš„ï¼Œå› çˆ²æº–å‚™å€‰ä¿ƒï¼Œæ²’æœ‰å›ç¦®ï¼Œå¾ˆç›£ä»‹ã€‚ã€‚ã€‚)ä¸€äº›éšŠå‹ä»Šæ—¥å›å»ï¼Œæˆ‘å»San Jose International Airportï¼Œriatreå’Œmarche147ä¹˜åDelta Airï¼Œåœ¨Seattleè½‰æ©Ÿå›åŒ—äº¬ã€‚æˆ‘å› çˆ²å’Œiromiseåˆæª¢æŸ¥äº†ä¸‹å¥—æˆ¿è¡†äººè½ä¸‹çš„æ±è¥¿ï¼Œé›¢é–‹å¾—ç¨æ™šäº†ï¼Œå°±è¢«æ‹‹ä¸‹äº†ğŸ˜­åˆåªå¥½ç¨è‡ªæ‰“è»Šåˆ°æ©Ÿå ´ï¼Œå¥½åœ¨åœ¨æ©Ÿå ´ç¢°é ­äº†ï¼Œé‚„é‡åˆ°äº†A*0*E (0ops)çš„è°­å‡Œéœ„ã€‚å¤§éƒ¨éšŠä¹˜åKorean Airï¼Œé‚„æœ‰å¹¾å€‹å ±äº†æ—…éŠåœ˜åœ¨Planet Hollywoodä½å…©å¤©å†å›å»ã€‚Mistyå’ŒHITCONä¹˜ååŒä¸€å€‹Korean Airèˆªç­ã€‚æˆ‘ç¬¬ä¸€æ¬¡åœ¨SJCå‡ºç™¼é›¢é–‹ï¼Œç™¼ç¾æœ‰å€‹ride-sharing appçš„é€šé“ã€‚

ä¸»è¾¦æ–¹çš„éå¤±å¾ˆå¤šï¼š

* ç¶²çµ¡ç’°å¢ƒé…ç½®ã€‚Day2é–‹è³½æ™‚é–“æ‹–å»¶äº†å…©å€‹å°æ™‚æœ‰é»é•·ï¼Œä»¥å‰legitbså¾æ²’æœ‰æ‹–åˆ°éå…©å°æ™‚ã€‚
* ä¸æ…æš´éœ²çš„Admin interfaceã€‚
* patchä¸Šå‚³æ©Ÿåˆ¶ã€‚git repoçœ‹èµ·ä¾†å¾ˆé…·ï¼Œä½†ç”¨git post-commit hookå¯¦ç¾çš„è©±å®¹æ˜“å‡ºå•é¡Œã€‚ç©©å¥çš„HTTP POSTæŒºå¥½çš„ï¼Œé‚„æ–¹ä¾¿é™åˆ¶æäº¤æ¬¡æ•¸ã€‚
* åˆ†æ•¸è¨ˆç®—bugã€‚é‚„å¥½æ•¸æ“šåº«è¨˜éŒ„äº†åŸå§‹äº‹ä»¶ï¼Œæ–¹ä¾¿é‡æ–°è¨ˆç®—ã€‚
* ä¸æ³¨æ„sandboxéš”é›¢ã€‚
* æ²’æœ‰æ³¨æ„æœå‹™çš„è³‡æºæ¶ˆè€—
  + bew Denial of Serviceå¾ˆé›£é˜²ã€‚Node.jsçš„å–®é€²ç¨‹æœå‹™å¤šå€‹é€£æ¥çš„æ¨¡å‹åœ¨æ”»é˜²è£ä¸å¥½ï¼Œæœå‹™å®¹æ˜“è¢«æå£ã€‚å¾Œä¾†ä¸»è¾¦æ–¹æ”¹æˆä¸åœé‡å•“nodeï¼Œåˆæœƒå°è‡´å¤§é‡è³‡æºæ¶ˆè€—ã€‚
  + æ…ç”¨qemuæ¨¡æ“¬é‹è¡Œçš„ç¨‹åºã€‚qemu-mipsé‹è¡Œçš„pointlessæ¶ˆè€—å¤§é‡è³‡æºã€‚è½èªªä¸»è¾¦æ–¹åŸä¾†å‡ºäº†ä¸€é“x86_64çš„ï¼Œä½†å¾Œä¾†æœ‰äººéˆæ©Ÿä¸€å‹•æŠŠå®ƒæ”¹æˆäº†32ä½MIPSã€‚æ“šèªªPPPåˆ©ç”¨leakæ™‚ï¼Œæ›¾ç™¼ç¾æœå‹™ç«¯ä¸å°å‹(x86_64æ²’æœ‰è¢«é¡Œæ›æˆMIPS)ï¼Œä¹‹å¾Œä¸»è¾¦æ–¹æ‰ä¿®å¾©ã€‚

ä½†ä»–å€‘æ‰›ä¸‹legitbsé›¢é–‹å¾Œä¸»è¾¦æ–¹çš„å¤§æ——ï¼Œå¾ˆä¸å®¹æ˜“ï¼Œçˆ²æ¯”è³½å¸¶ä¾†æ–°çš„è³½åˆ¶(è¡€æ¶²)ï¼Œæ„Ÿè¬ä»–å€‘çš„è¾›å‹¤å‹å‹•ã€‚å¸Œæœ›ä»¥å¾Œèƒ½è¾¦å¾—æ›´å¥½ã€‚

æˆ‘å€‘è‡ªèº«çš„å•é¡Œï¼š

* èˆªç­å»¶èª¤ä¸€å¤©çµ¦å¤§å®¶å¸¶ä¾†æ™‚å·®å½±éŸ¿ã€‚å¾ˆå¤šäººæ˜æ˜æ²‰æ²‰çš„ï¼Œä¸èƒ½ç™¼æ®æœ€ä½³ç‹€æ…‹ã€‚æˆ‘é›–ç„¶æ²’æœ‰æ™‚å·®å½±éŸ¿ï¼Œä½†å½·å½¿æ°´åœŸä¸æœ(æ—ç™½ï¼šè«‹ä¸è¦æ‰¾è—‰å£)
* æº–å‚™ä¸è¶³ã€‚å»å¹´(cLEMENCy)æå‰ä¸€å¤©çŸ¥é“è¦å‰‡ï¼Œåšäº†å¾ˆå¤šæº–å‚™ï¼Œå¦‚git repoã€‚ä»Šå¹´æœ‰æ‰€æ¬ ç¼ºã€‚
* ä»Šå¹´Day 1çµæŸå¾Œæ²’æœ‰ç¸½çµã€‚

æ¯å¹´å…«æœˆï¼Œæ”¾ä¸‹æ‰‹é ­çš„å·¥ä½œï¼Œåœ¨Las Vegasè¦‹æ•…äº¤æ–°çŸ¥ï¼Œä¸¦è‚©ä½œæˆ°ï¼ŒæŠ˜é¨°å¹³æ™‚ä¸æƒ³æŠ˜é¨°çš„è»Ÿä»¶ï¼Œé€Ÿæˆå¹³æ™‚ç”¨ä¸åˆ°çš„æŠ€èƒ½ï¼Œç¹¼çºŒç™¼å…‰ç™¼ç†±(èˆ‡å…¶è®“ç”Ÿå‘½ç”Ÿé½)ï¼Œäº«å—é€™æ®µæ™‚å…‰ã€‚
